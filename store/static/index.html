<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bv & Bl</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .img-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .img-container img {
            width: 100%; 
            height: auto; 
        }
        .img-container button {
            margin-top: 10px; 
        }
        .icon-large {
            font-size: 3rem; /* Размер иконок */
            margin-bottom: 10px; /* Отступ снизу */
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm bg-dark fixed-top py-3">
            <div class="container-fluid">
                <a class="navbar-brand text-white" href="index.html">Bv & Bl</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="registration.html">Registration</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="login.html">Login</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="catalog.html" onclick="checkCatalogLogin(event)">Catalog</a>
                            <p id="catalogWarning" style="color: red; display: none;">Not logged in</p>
                        </li>
                    </ul>
                    <ul class="navbar-nav" id="adminPanelNav" style="display: none;">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="/admin.html">Admin Panel</a>
                        </li>
                    </ul>
                    
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="cart.html">
                                <i class="fas fa-shopping-cart"></i> Cart
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav" id="userNav" style="display: none;">
                        <li class="nav-item">
                            <span class="nav-link text-white" id="usernameDisplay"></span>
                        </li>
                        <li class="nav-item">
                            <button class="btn btn-outline-light" id="logoutBtn">Logout</button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div>
            <img src="https://static.zara.net/assets/public/ad43/1d68/c662497292f0/95aef629b74b/image-landscape-fill-cc081324-6647-4cc5-999f-8b94bd646664-default_0/image-landscape-fill-cc081324-6647-4cc5-999f-8b94bd646664-default_0.jpg?ts=1737723976207&w=2561" class="d-block w-100" alt="...">
        </div>
        
        <div class="container">
            <div class="row">
                <div class="col-12 col-md-4 text-center mb-4 img-container">
                    <i class="fas fa-tshirt icon-large"></i>
                    <img src="https://static.zara.net/assets/public/d15f/14c0/88514fb8b7f1/2b8b2414f632/04806401800-e1/04806401800-e1.jpg?ts=1734946681063&w=850" alt="Black Jeans" class="img-fluid">
                    <button type="button" class="btn btn-secondary mt-3" onclick="checkLogin(event, 'black_jeans.html')">More...</button>
                    <p class="loginWarning" style="color: red; display: none;">Log in first</p>
                </div>
                <div class="col-12 col-md-4 text-center mb-4 img-container">
                    <i class="fas fa-shoe-prints icon-large"></i>
                    <img src="https://static.zara.net/assets/public/429e/4b44/bb7646b6a9c4/6aff2ce1329f/04087400251-e1/04087400251-e1.jpg?ts=1737028984288&w=850" alt="White T-Shirt" class="img-fluid">
                    <button type="button" class="btn btn-secondary mt-3" onclick="checkLogin(event, 'white_t_shirt.html')">More...</button>
                    <p class="loginWarning" style="color: red; display: none;">Log in first</p>
                </div>
                <div class="col-12 col-md-4 text-center mb-4 img-container">
                    <i class="fas fa-hat-cowboy icon-large"></i>
                    <img src="https://static.zara.net/assets/public/b155/37f7/ce8245aba1c2/0135179a768b/06792865401-e1/06792865401-e1.jpg?ts=1727775303398&w=850" alt="Pidjak" class="img-fluid">
                    <button type="button" class="btn btn-secondary mt-3" onclick="checkLogin(event, 'man_pidjak.html')">More...</button>
                    <p class="loginWarning" style="color: red; display: none;">Log in first</p>
                </div>
            </div>
        </div>
        

        <div class="container-fluid bg-dark text-white py-5">
            <div class="row">
                <div class="col-12 col-md-6 mb-4 mb-md-0">
                    <h2>Quote from our brand review by leading news</h2>
                    <p>From What World Says</p>
                    <blockquote>"Bv & Bl is not just a clothing store. We create basic items that emphasize <b><i>individuality</i></b> and become the basis of any wardrobe. Fashionable, high-quality and versatile clothing for men, women, and children - everything you need to create a style for every day."</blockquote>
                </div>
                <div class="col-12 col-md-6">
                    <h2>About us</h2>
                    <p id="textBig">We are a young company offering <b><i>fashionable and high-quality</i></b> clothing, creating basic items that will become indispensable elements of everyone's wardrobe. Our goal is to offer stylish and versatile solutions for everyday life that combine comfort, modern design, and durability.</p>
                </div>
            </div>
        </div>

        <section id="contact" class="mt-5 mb-0">
            <div class="bg-secondary text-white text-center footers">
                <footer py-4>
                    <h2>Bv & Bl</h2><br>
                    <p>The site is made by Abylay Moldakhmet SE-2306</p>
                    <button type="button" class="btn btn-outline-secondary"><a style="font-size: 20px;" href="https://t.me/bvbl1">Telegram</a><br><br></button>
                    <p>our mail: 230457@astanait.edu.kz</p>
                </footer>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const userNav = document.getElementById("userNav");
            const usernameDisplay = document.getElementById("usernameDisplay");
            const logoutBtn = document.getElementById("logoutBtn");
            const adminPanelNav = document.getElementById("adminPanelNav");
    
            function checkAuth() {
                fetch("/getUser", {
                    method: "GET",
                    credentials: "include"
                })
                .then(response => {
                    if (!response.ok) throw new Error("Unauthorized");
                    return response.json();
                })
                .then(data => {
                    console.log("DEBUG: User data from getUser =", data); // Проверка
    
                    if (data.email) {
                        usernameDisplay.textContent = data.email;
                        userNav.style.display = "flex";
    
                        if (data.role === "admin") {
                            adminPanelNav.style.display = "flex"; // Показываем кнопку "Admin Panel"
                        } else {
                            adminPanelNav.style.display = "none"; // Скрываем для обычных пользователей
                        }
                    } else {
                        userNav.style.display = "none";
                        adminPanelNav.style.display = "none";
                    }
                })
                .catch(() => {
                    document.cookie = "Authorization=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 UTC;";
                    userNav.style.display = "none";
                    adminPanelNav.style.display = "none";
                });
            }
    
            logoutBtn.addEventListener("click", function () {
                fetch("/logout", { method: "POST", credentials: "include" }) 
                .then(() => {
                    document.cookie = "Authorization=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 UTC;";
                    usernameDisplay.textContent = "";
                    userNav.style.display = "none";
                    adminPanelNav.style.display = "none";
                    window.location.href = "/index.html";
                });
            });
    
            checkAuth(); // Проверка авторизации при загрузке страницы
    
        
        });
        function checkLogin(event, url) {
                event.preventDefault();
                const warningMessage = event.target.parentElement.querySelector(".loginWarning");
    
                fetch("/getUser", {
                    method: "GET",
                    credentials: "include"
                })
                .then(response => response.json())
                .then(data => {
                    if (data.email) { // Проверяем email вместо username
                        window.location.href = url;
                    } else {
                        warningMessage.style.display = "block";
                    }
                })
                .catch(error => {
                    console.error("Error checking login:", error);
                    warningMessage.style.display = "block";
                });
            }
    
            function checkCatalogLogin(event) {
                event.preventDefault(); // Останавливаем переход по ссылке
    
                const warningMessage = document.getElementById("catalogWarning");
    
                fetch("/getUser", {
                    method: "GET",
                    credentials: "include"
                })
                .then(response => response.json())
                .then(data => {
                    if (data.email) { // Проверяем email вместо username
                        window.location.href = "catalog.html"; // Если залогинен, переходим
                    } else {
                        warningMessage.style.display = "block"; // Показываем ошибку
                    }
                })
                .catch(error => {
                    console.error("Error checking login:", error);
                    warningMessage.style.display = "block";
                });
            }
    </script>
    
    
    
    
</body>
</html>